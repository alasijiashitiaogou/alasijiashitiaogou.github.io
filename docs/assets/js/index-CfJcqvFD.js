import{_ as $e,r as h,c as Ie,a as Se,o as Ee,b as k,d as m,e as c,f as V,g as z,w as Y,h as p,t as D,F as Z,i as ee,n as Q,j as S,k as v,l as _,m as A,p as je,E as C,q as le,s as F}from"./index-Bq_my5ma.js";const x=[];for(let o=0;o<256;++o)x.push((o+256).toString(16).slice(1));function Te(o,s=0){return(x[o[s+0]]+x[o[s+1]]+x[o[s+2]]+x[o[s+3]]+"-"+x[o[s+4]]+x[o[s+5]]+"-"+x[o[s+6]]+x[o[s+7]]+"-"+x[o[s+8]]+x[o[s+9]]+"-"+x[o[s+10]]+x[o[s+11]]+x[o[s+12]]+x[o[s+13]]+x[o[s+14]]+x[o[s+15]]).toLowerCase()}let q;const Ke=new Uint8Array(16);function Be(){if(!q){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");q=crypto.getRandomValues.bind(crypto)}return q(Ke)}const De=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ae={randomUUID:De};function G(o,s,r){var t;if(ae.randomUUID&&!o)return ae.randomUUID();o=o||{};const d=o.random??((t=o.rng)==null?void 0:t.call(o))??Be();if(d.length<16)throw new Error("Random bytes length must be >= 16");return d[6]=d[6]&15|64,d[8]=d[8]&63|128,Te(d)}function T(o){let s=0;for(let r of o)if(["K","Q","J","10"].includes(r))s+=0;else if(r==="A")s+=1;else{const d=parseInt(r);if(isNaN(d)||d<1||d>9)throw new Error(`无效的牌面: ${r}. 牌面必须是 A, K, Q, J, 10-2 或数字 1-9。`);s+=d}return s%10}function te(o,s){const r=T(o),d=T(s);return r===d?"和局":r>d?"庄家":"闲家"}function Le(o){let s=[],r=[],d=0;const t=()=>{if(d>=o.length)throw new Error("牌数不足以完成本局游戏。");return o[d++]};try{s.push(t()),r.push(t()),s.push(t()),r.push(t())}catch{throw new Error("牌数不足，无法开始游戏。每局至少需要4张牌。")}const y=T(s),b=T(r);if(y>=8||b>=8)return{playerHand:s,bankerHand:r,winner:te(r,s),cardsUsed:d};let g=!1;if(y<=5)try{s.push(t()),g=!0}catch{throw new Error("牌数不足，闲家无法补牌。")}const I=g?T([s[2]]):-1,w=T(r);if(g){if(w<=2)try{r.push(t())}catch{throw new Error("牌数不足，庄家无法补牌。")}else if(w===3&&I!==8)try{r.push(t())}catch{throw new Error("牌数不足，庄家无法补牌。")}else if(w===4&&[2,3,4,5,6,7].includes(I))try{r.push(t())}catch{throw new Error("牌数不足，庄家无法补牌。")}else if(w===5&&[4,5,6,7].includes(I))try{r.push(t())}catch{throw new Error("牌数不足，庄家无法补牌。")}else if(w===6&&[6,7].includes(I))try{r.push(t())}catch{throw new Error("牌数不足，庄家无法补牌。")}}else if(w<=5)try{r.push(t())}catch{throw new Error("牌数不足，庄家无法补牌。")}return{playerHand:s,bankerHand:r,winner:te(r,s),cardsUsed:d}}const Re={class:"poker-game"},ze={key:0,class:"login-overlay"},He={class:"login-container"},Je={class:"login-box"},Qe={class:"login-form"},Ae={key:0,class:"login-error"},Ne={key:1},Me={class:"top-nav"},Fe={class:"nav-user"},qe={class:"username"},Ge={class:"search-area"},Oe={class:"search-container"},Pe={class:"card-container"},We=["data-card-id","onClick"],Xe={class:"card-value"},Ye={key:0,class:"empty-state"},Ze={class:"options-grid"},el=["onClick"],ll={key:0},al={key:1,class:"card-option"},tl={key:2,class:"option-label"},sl={class:"result-content"},nl={class:"edit-dialog-content"},ul={class:"dialog-footer"},rl={__name:"index",setup(o){const s=h(!1),r=h(null),d=h(null),t=h([]),y=h([]),b=h(300),g=h(null),I=h(!1),w=h({username:"",password:""}),$=h(!1),K=h(""),H=h(""),N=h(!1),L=h([]),R=h(!1),B=h(!1),E=h(""),J=h(!1),se=Ie(()=>localStorage.getItem("bjlc_username")||"admin"),ne=Se([{value:"empty",display:"清空"},{value:"K",display:"K"},{value:"back",display:"删除"},{value:"1",display:"1"},{value:"2",display:"2"},{value:"3",display:"3"},{value:"4",display:"4"},{value:"5",display:"5"},{value:"6",display:"6"},{value:"7",display:"7"},{value:"8",display:"8"},{value:"9",display:"9"},{value:"10",display:"10"},{value:"J",display:"J"},{value:"Q",display:"Q"}]),ue=l=>{switch(d.value=l.value,l.value){case"empty":oe();break;case"back":ie();break;default:re()}},re=()=>{if(r.value&&d.value){const l={id:G(),value:d.value,display:d.value},e=t.value.findIndex(n=>n.id===r.value);t.value.splice(e+1,0,l),d.value=null,r.value=null,le(()=>{const n=document.querySelector(".card-container");n.scrollTop=n.scrollHeight})}if(d.value){const l={id:G(),value:d.value,display:d.value};t.value.push(l),d.value=null,le(()=>{const e=document.querySelector(".card-container");e.scrollTop=e.scrollHeight})}},oe=()=>{t.value.length!==0&&F.confirm("确定要清空所有卡片吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{t.value=[],d.value=null}).catch(()=>{})},ie=()=>{console.log("回退功能触发"),t.value.length>0&&t.value.pop()},O=l=>{if(["1","2","3"].includes(l))return"w-20%!";if(["4","5","6"].includes(l))return"w-40%!";if(["7","8","9"].includes(l))return"w-60%!";if(["J","Q","K"].includes(l))return"w-20%!"},de=l=>{if(r.value===l.id){r.value=null,g.value=null;return}if(r.value=l.id,s.value){let e=t.value.findIndex(a=>a.id===l.id),n=0;for(let a=0;a<y.value.length;a++)if(n+=y.value[a].cardsUsed||0,e<n){g.value=a;break}}},ce=(l,e,n)=>{if(!s.value)return;let a=y.value.findIndex(i=>i===l);g.value=a;let f=0;for(let i=0;i<a;i++)f+=y.value[i].cardsUsed||0;f+(l.cardsUsed||0),t.value[f]&&(r.value=t.value[f].id)},ve=()=>{t.value.length!==0&&r.value&&(t.value=t.value.filter(l=>l.id!==r.value),r.value=null)},P=()=>{if(t.value.length===0){C.warning("没有可复制的数据");return}const l=t.value.map(e=>e.display).join(" ");navigator.clipboard.writeText(l).then(()=>{C.success(`已复制 ${t.value.length} 张牌的数据到剪贴板`)}).catch(()=>{const e=document.createElement("textarea");e.value=l,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),C.success(`已复制 ${t.value.length} 张牌的数据到剪贴板`)})},pe=()=>{y.value=[];const l=t.value.map(a=>a.value);let e=0,n=0;for(;e<l.length;){n++;let a={};a.jushu=n;try{const f=l.slice(e),i=Le(f);e+=i.cardsUsed,a.zhuang=T(i.bankerHand),a.xian=T(i.playerHand),a.result=i.winner,a.cardsUsed=i.cardsUsed,y.value.push(a)}catch{C.error(`错误: 从第 ${e+1} 张牌开始`),t.value[e]&&(r.value=t.value[e].id),e=l.length;break}}if(n===0){C.error("无法识别任何有效的百家乐局。请检查输入格式。");return}b.value=400,s.value=!0,g.value=null},fe=()=>{E.value=t.value.map(l=>l.display).join(" "),B.value=!0},ye=()=>{J.value=!0;const l=E.value.trim();if(!l){t.value=[],y.value=[],s.value=!1,b.value=300,g.value=null,B.value=!1,J.value=!1,C.success("已清空所有数据");return}let e=[];const n=l.split(/\s+/).filter(i=>i.trim());for(const i of n)if(i.length===1){const U=i.toUpperCase();["1","2","3","4","5","6","7","8","9","J","Q","K"].includes(U)&&e.push(U)}else{const U=i.split("");for(let j=0;j<U.length;j++){const u=U[j];u==="1"&&j+1<U.length&&U[j+1]==="0"?(e.push("10"),j++):["1","2","3","4","5","6","7","8","9","J","Q","K"].includes(u.toUpperCase())&&e.push(u.toUpperCase())}}const a=["1","2","3","4","5","6","7","8","9","10","J","Q","K"],f=e.filter(i=>!a.includes(i));if(f.length>0){C.error(`无效的扑克牌数据: ${f.join(", ")}`),J.value=!1;return}t.value=e.map(i=>({id:G(),value:i.toUpperCase(),display:i.toUpperCase()})),y.value=[],s.value=!1,b.value=300,g.value=null,B.value=!1,J.value=!1,C.success(`已更新 ${t.value.length} 张牌的数据`)},ge=()=>{B.value=!1,E.value=""},he=()=>{E.value="",B.value=!0};function me(l){if(g.value==null||!s.value)return!1;let e=0;for(let a=0;a<g.value;a++)e+=y.value[a].cardsUsed||0;let n=e+(y.value[g.value].cardsUsed||0);return l>=e&&l<n}function we({row:l,rowIndex:e}){let n=[];return e===g.value&&n.push("result-active-row"),n.join(" ")}const _e=()=>{if(t.value.length!==0&&r.value){const l=t.value.findIndex(e=>e.id===r.value);l>0?F.confirm("确定要删除选中牌之前的所有牌吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{t.value=t.value.slice(l),r.value=null}).catch(()=>{}):l===0&&C.info("已经是第一张牌，无法删除此前的牌")}},xe=l=>{let e=0;for(let a=0;a<l;a++)e+=y.value[a].cardsUsed||0;const n=y.value[l].cardsUsed||0;t.value.splice(e,n),y.value.splice(l,1),g.value===l?(g.value=null,r.value=null):g.value>l&&g.value--},ke=()=>{localStorage.getItem("bjlc_login_status")==="true"&&(I.value=!0)},W=()=>{if(!w.value.username||!w.value.password){K.value="请输入用户名和密码";return}$.value=!0,K.value="",setTimeout(()=>{w.value.username==="admin"&&w.value.password==="kun@123"?(I.value=!0,localStorage.setItem("bjlc_login_status","true"),localStorage.setItem("bjlc_username",w.value.username),K.value="",C.success("登录成功！")):(K.value="用户名或密码错误",C.error("登录失败，请检查用户名和密码")),$.value=!1},500)},X=()=>{if(!H.value.trim()){C.warning("请输入搜索关键字");return}N.value=!0,R.value=!0,setTimeout(()=>{const l=H.value.toLowerCase().trim(),e=[];if(t.value.forEach((n,a)=>{n.display.toLowerCase().includes(l)&&e.push({type:"card",index:a,card:n,display:`第${a+1}张牌: ${n.display}`})}),l.length>1){const n=l.split("");for(let a=0;a<=t.value.length-n.length;a++){let f=!0;for(let i=0;i<n.length;i++)if(t.value[a+i].display.toLowerCase()!==n[i]){f=!1;break}if(f)for(let i=0;i<n.length;i++){const U=t.value[a+i];e.push({type:"card",index:a+i,card:U,display:`连续模式${l}: 第${a+i+1}张牌 ${U.display}`,isContinuous:!0,continuousGroup:a})}}}y.value.length>0&&y.value.forEach((n,a)=>{`${n.zhuang}-${n.xian}-${n.result}`.toLowerCase().includes(l)&&e.push({type:"result",index:a,result:n,display:`第${n.jushu}局: 庄${n.zhuang} 闲${n.xian} ${n.result}`})}),L.value=e,N.value=!1,e.length===0?(C.info("未找到匹配的结果"),R.value=!1):C.success(`找到 ${e.length} 个匹配结果`)},300)},Ce=()=>{H.value="",L.value=[],R.value=!1},be=l=>!R.value||L.value.length===0?!1:L.value.some(e=>e.type==="card"&&e.card.id===l.id),Ue=l=>!R.value||L.value.length===0?!1:L.value.some(e=>e.type==="card"&&e.card.id===l.id&&e.isContinuous),Ve=()=>{F.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{I.value=!1,localStorage.removeItem("bjlc_login_status"),localStorage.removeItem("bjlc_username"),w.value={username:"",password:""},K.value="",C.success("已退出登录")}).catch(()=>{})};return Ee(()=>{ke()}),(l,e)=>{const n=z("el-input"),a=z("el-button"),f=z("el-table-column"),i=z("el-tag"),U=z("el-table"),j=z("el-dialog");return v(),k("div",Re,[I.value?(v(),k("div",Ne,[c("div",Me,[e[11]||(e[11]=c("div",{class:"nav-title"},"百家乐计算器",-1)),c("div",Fe,[c("span",qe,"欢迎，"+D(se.value),1),m(a,{type:"danger",size:"small",onClick:Ve},{default:p(()=>e[10]||(e[10]=[_(" 退出登录 ")])),_:1,__:[10]})])]),c("div",Ge,[c("div",Oe,[m(n,{modelValue:H.value,"onUpdate:modelValue":e[2]||(e[2]=u=>H.value=u),placeholder:"输入关键字搜索",class:"search-input",clearable:"",onKeyup:Y(X,["enter"]),onClear:Ce},{append:p(()=>[m(a,{onClick:X,loading:N.value},{default:p(()=>e[12]||(e[12]=[_(" 搜索 ")])),_:1,__:[12]},8,["loading"])]),_:1},8,["modelValue"])])]),c("div",{class:"card-display-area",style:Q({height:`calc(100vh - ${b.value}px - 60px - 60px)`})},[c("div",Pe,[(v(!0),k(Z,null,ee(t.value,(u,M)=>(v(),k("div",{key:u.id,"data-card-id":u.id,onClick:ol=>de(u),class:A(["playing-card",[{active:r.value===u.id},s.value&&me(M)?"result-active-card":"",R.value&&be(u)?Ue(u)?"search-highlight-continuous-card":"search-highlight-card":""]])},[c("div",Xe,D(u.display),1)],10,We))),128)),t.value.length===0?(v(),k("div",Ye," 请录入信息 ")):V("",!0)]),e[13]||(e[13]=c("div",{class:"h-46px w-100%"},null,-1))],4),c("div",{class:"shuffle-button",style:Q({bottom:`${b.value+8}px`})},[!s.value&&t.value.length>0?(v(),S(a,{key:0,type:"primary",round:"",class:"w-100px",onClick:pe},{default:p(()=>e[14]||(e[14]=[_("计算")])),_:1,__:[14]})):V("",!0),s.value?(v(),S(a,{key:1,round:"",class:"w-100px",onClick:fe},{default:p(()=>e[15]||(e[15]=[_("修改")])),_:1,__:[15]})):V("",!0),s.value&&b.value<400?(v(),S(a,{key:2,type:"warning",round:"",class:"w-100px ml-10px",onClick:e[3]||(e[3]=u=>b.value=400)},{default:p(()=>e[16]||(e[16]=[_("更高展示")])),_:1,__:[16]})):V("",!0),s.value&&b.value>300?(v(),S(a,{key:3,type:"warning",round:"",class:"w-100px ml-10px",onClick:e[4]||(e[4]=u=>b.value=300)},{default:p(()=>e[17]||(e[17]=[_("恢复高度")])),_:1,__:[17]})):V("",!0),s.value?(v(),S(a,{key:4,type:"warning",round:"",class:"w-100px ml-10px",onClick:P},{default:p(()=>e[18]||(e[18]=[_("复制全部")])),_:1,__:[18]})):V("",!0),!s.value&&t.value.length>0?(v(),S(a,{key:5,type:"danger",round:"",class:"w-100px",onClick:ve},{default:p(()=>e[19]||(e[19]=[_("删除选中")])),_:1,__:[19]})):V("",!0),!s.value&&t.value.length>0?(v(),S(a,{key:6,type:"info",round:"",class:"w-100px",onClick:_e},{default:p(()=>e[20]||(e[20]=[_("删除此前")])),_:1,__:[20]})):V("",!0),!s.value&&t.value.length>0?(v(),S(a,{key:7,type:"warning",round:"",class:"w-100px ml-10px",onClick:P},{default:p(()=>e[21]||(e[21]=[_("复制全部")])),_:1,__:[21]})):V("",!0),!s.value&&t.value.length===0?(v(),S(a,{key:8,type:"primary",round:"",class:"w-100px",onClick:he},{default:p(()=>e[22]||(e[22]=[_("粘贴数据")])),_:1,__:[22]})):V("",!0)],4),s.value?(v(),k("div",{key:1,class:"input-result",style:Q({height:`${b.value}px`})},[e[24]||(e[24]=c("div",{class:"result-title mb-10px"},"计算结果",-1)),c("div",sl,[m(U,{class:"text-12px w-100%",data:y.value,style:{width:"100%"},height:b.value-50,"row-class-name":we,onRowClick:ce},{default:p(()=>[m(f,{property:"zhuang",align:"center",label:"庄"}),m(f,{property:"xian",align:"center",label:"闲"}),m(f,{property:"result",align:"center",label:"结果"},{default:p(u=>[m(i,{type:u.row.result==="和局"?"success":u.row.result==="庄家"?"danger":"primary",effect:"dark"},{default:p(()=>[_(D(u.row.result),1)]),_:2},1032,["type"])]),_:1}),m(f,{property:"jushu",align:"center",label:"局数"},{default:p(u=>[_(" 第"+D(u.row.jushu)+"局 ",1)]),_:1}),m(f,{label:"操作",align:"center"},{default:p(u=>[m(a,{type:"danger",size:"small",onClick:je(M=>xe(u.$index),["stop"])},{default:p(()=>e[23]||(e[23]=[_("删除")])),_:2,__:[23]},1032,["onClick"])]),_:1})]),_:1},8,["data","height"])])],4)):(v(),k("div",{key:0,class:"input-options",style:Q({height:`${b.value}px`})},[c("div",Ze,[(v(!0),k(Z,null,ee(ne,u=>(v(),k("div",{key:u.value,class:A(["option-button",{selected:d.value===u.value}]),onClick:M=>ue(u)},[u.display==="清空"||u.display==="删除"?(v(),k("div",ll,D(u.display),1)):(v(),k("div",al,[c("span",{class:A(O(u.display))},null,2),["J","Q","K"].includes(u.display)?(v(),k("span",{key:0,class:A(["ml-20px",O(u.display)])},null,2)):V("",!0)])),["清空","删除"].includes(u.display)?V("",!0):(v(),k("label",tl,D(u.display),1))],10,el))),128))])],4))])):(v(),k("div",ze,[c("div",He,[c("div",Je,[e[9]||(e[9]=c("h2",null,"百家乐计算器",-1)),c("div",Qe,[m(n,{modelValue:w.value.username,"onUpdate:modelValue":e[0]||(e[0]=u=>w.value.username=u),placeholder:"请输入用户名","prefix-icon":"User",size:"large",class:"login-input"},null,8,["modelValue"]),m(n,{modelValue:w.value.password,"onUpdate:modelValue":e[1]||(e[1]=u=>w.value.password=u),type:"password",placeholder:"请输入密码","prefix-icon":"Lock",size:"large",class:"login-input",onKeyup:Y(W,["enter"])},null,8,["modelValue"]),m(a,{type:"primary",size:"large",class:"login-button",onClick:W,loading:$.value},{default:p(()=>e[7]||(e[7]=[_(" 登录 ")])),_:1,__:[7]},8,["loading"]),K.value?(v(),k("div",Ae,D(K.value),1)):V("",!0),e[8]||(e[8]=c("div",{class:"login-tips"},[c("p",null,"测试账号：admin"),c("p",null,"测试密码：kun@123")],-1))])])])])),m(j,{modelValue:B.value,"onUpdate:modelValue":e[6]||(e[6]=u=>B.value=u),title:E.value?"编辑扑克牌数据":"粘贴数据",width:"90%","close-on-click-modal":!1,"close-on-press-escape":!1,class:"edit-dialog"},{footer:p(()=>[c("span",ul,[m(a,{onClick:ge,size:"large"},{default:p(()=>e[25]||(e[25]=[_("取消")])),_:1,__:[25]}),m(a,{type:"primary",onClick:ye,loading:J.value,size:"large"},{default:p(()=>e[26]||(e[26]=[_(" 完成 ")])),_:1,__:[26]},8,["loading"])])]),default:p(()=>[c("div",nl,[m(n,{modelValue:E.value,"onUpdate:modelValue":e[5]||(e[5]=u=>E.value=u),type:"textarea",rows:12,placeholder:E.value?"请输入扑克牌数据（例如：12345JQK）":"请粘贴或输入扑克牌数据（例如：12345JQK）",class:"edit-textarea"},null,8,["modelValue","placeholder"])])]),_:1},8,["modelValue","title"])])}}},dl=$e(rl,[["__scopeId","data-v-cc27646f"]]);export{dl as default};
